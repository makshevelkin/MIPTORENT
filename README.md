## О проекте

FastAPI‑сервис аренды с разделением по модулям (конфигурация, модели, роуты, сервисы). Код разложен так, чтобы новые участники могли быстро ориентироваться и вносить правки без конфликтов.

## Структура

- `app/config.py` — базовые настройки (пути, БД, сессионные cookie, лимиты загрузок).
- `app/database.py` — подключение к БД, SessionLocal, Base, зависимость `get_db`.
- `app/models.py` — модели SQLAlchemy (User, Category, Item, ItemImage, Order).
- `app/utils.py` — вспомогательные функции: CSRF, флеши, корзина, загрузка файлов, парсинг дат, тарифы, проверки пересечений.
- `app/seed.py` — миграции схемы (ensure_schema) и начальные данные (seed_data), инициализация БД.
- `app/routes/` — изолированные роутеры: `public` (каталог/товар), `auth` (аутентификация, профиль), `cart` (корзина/оплата), `admin` (товары/категории).
- `templates/`, `static/` — фронт.
- `app/main.py` — сборка приложения, middleware, подключение роутеров.
- `app/__init__.py` — экспорт `app`.

## Запуск

1. Установите зависимости (внутри venv):
   ```
   pip install -r requirements.txt
   ```
2. Задайте переменные окружения (пример для PowerShell):
   ```
   $env:SESSION_SECRET = "<длинный_секрет>"
   $env:SESSION_COOKIE_SECURE = "1"    # включать на HTTPS
   $env:SESSION_COOKIE_SAMESITE = "lax" # или "strict"
   ```
3. Запустите:
   ```
   uvicorn app.main:app --reload
   ```

## Учётные данные

- Администратор: `admin123@example.com` / `2a6-Nvc-36h-LKc`
- Демо‑пользователь: `user@example.com` / `test1234`

## Набор данных по умолчанию

При старте автоматически создаются категории (Электроника, Одежда, Спорттовары, Инструменты), примеры товаров и заказы демонстрации. Логика описана в `app/seed.py`.

## Безопасность (базовый уровень)

- CSRF‑токены на HTML‑формах.
- Сессионные cookie с параметрами Secure/SameSite (задаются через env).
- Лимиты и фильтр форматов при загрузке файлов.
- Проверка пересечений бронирований с заказами и корзиной.

Перед продакшеном обязательно задайте свой `SESSION_SECRET`, включите HTTPS (`SESSION_COOKIE_SECURE=1`), отключите debug‑отправку токенов и добавьте rate limiting/Origin‑проверки, если планируется публичный доступ.
